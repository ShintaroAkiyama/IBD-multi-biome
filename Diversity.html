<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2487.6">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px 'Helvetica Neue'; -webkit-text-stroke: #000000}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px 'Helvetica Neue'; -webkit-text-stroke: #000000; min-height: 15.0px}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 20.0px 'Helvetica Neue'; -webkit-text-stroke: #000000}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px 'Hiragino Sans'; -webkit-text-stroke: #000000}
    p.p5 {margin: 0.0px 0.0px 2.0px 0.0px; font: 16.0px 'Hiragino Sans'; -webkit-text-stroke: #000000}
    span.s1 {font-kerning: none}
    span.s2 {font: 13.0px 'Hiragino Sans'; font-kerning: none}
    span.s3 {font: 16.0px 'Helvetica Neue'; font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html&gt;</span></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta charset="utf-8"&gt;</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1">&lt;body&gt;</span></p>
<p class="p3"><span class="s1"><b>#Bacterial Species</b></span></p>
<p class="p1"><span class="s1">#Alpha-diversity</span></p>
<p class="p1"><span class="s1">#Shannon</span></p>
<p class="p1"><span class="s1">SP_input &lt;- read.csv("SP_IBD.csv", header = TRUE, na.strings = c(NA, ''), row.names=1) #abundance data</span></p>
<p class="p1"><span class="s1">SP_input2 &lt;- SP_input[, -which (colnames(SP_input) %in% c("ID", "IBD", "UC", "CD"))]<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1">DATA=otu_table(SP_input2, taxa_are_rows = FALSE)</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Shannon_SP&lt;-diversity(SP_input2,index="<b>shannon</b>",base=2) %&gt;% as.data.frame()<span class="Apple-converted-space">  </span>#Simpson, invsimpson</span><span class="s2"> can be selected.</span></p>
<p class="p1"><span class="s1">colnames(Shannon_SP)[1] &lt;- "Shannon"</span></p>
<p class="p1"><span class="s1">rownames_to_column(Shannon_SP, "METAF") -&gt; Shannon_SP</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Shannon_SP &lt;- full_join(Shannon_SP, Meta, by = "METAF")</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">ggplot(Shannon_SP, aes(Group, Shannon, fill = Group)) +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_violin(aes(group = Group), width = 0.5) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_fill_manual(values = c("royalblue","#84919e","red"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_boxplot(aes(group = Group), fill = "white", width = 0.1) +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme_classic() +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>labs(x = "", y = "Shannon for species") +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_y_continuous(limits = c(0, 8.5)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_x_discrete(limit=c("Controls","UC","CD"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme(axis.text.x = element_text(angle = 0, hjust = 0.5, size = 18),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>axis.text.y = element_text(angle = 0, hjust = 0.5, size = 18),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>text = element_text(size = 18)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 1.5, y = 8, label = "P &lt; 0.001", size = 6, fontface = "plain") +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_segment(x = 1, xend = 2, y = 7.8, yend = 7.8) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 2, y = 8.5, label = "P &lt; 0.001", size = 6, fontface = "plain")+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_segment(x = 1, xend = 3, y = 8.3, yend = 8.3)+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 2.5, y = 7.7, label = "P = <b>0.007</b>", size = 6, fontface = "plain")+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_segment(x = 2, xend = 3, y = 7.5, yend = 7.5)+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>guides(fill=guide_legend(title=NULL))</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">#Simpson</span></p>
<p class="p1"><span class="s1">SP_input &lt;- read.csv("SP_IBD.csv", header = TRUE, na.strings = c(NA, ''), row.names=1) #abundance data</span></p>
<p class="p1"><span class="s1">SP_input2 &lt;- SP_input[, -which (colnames(SP_input) %in% c("ID", "IBD", "UC", "CD"))]<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1">DATA=otu_table(SP_input2, taxa_are_rows = FALSE)</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Simpson_SP&lt;-diversity(SP_input2,index="<b>simpson</b>",base=2) %&gt;% as.data.frame()<span class="Apple-converted-space">  </span>#Simpson, invsimpson</span><span class="s2"> can be selected.</span></p>
<p class="p1"><span class="s1">colnames(Simpson_SP)[1] &lt;- "Simpson"</span></p>
<p class="p1"><span class="s1">rownames_to_column(Simpson_SP, "METAF") -&gt; Simpson_SP</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Simpson_SP &lt;- full_join(Simpson_SP, Meta, by = "METAF")</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">ggplot(Simpson_SP, aes(Group, Simpson, fill = Group)) +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_violin(aes(group = Group), width = 0.5) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_fill_manual(values = c("royalblue","#84919e","red"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_boxplot(aes(group = Group), fill = "white", width = 0.1) +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme_classic() +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>labs(x = "", y = "Simpson for species") +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_y_continuous(limits = c(0, 1.3)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_x_discrete(limit=c("Controls","UC","CD"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme(axis.text.x = element_text(angle = 0, hjust = 0.5, size = 18),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>axis.text.y = element_text(angle = 0, hjust = 0.5, size = 18),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>text = element_text(size = 18)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 1.5, y = 1.15, label = "P &lt; 0.001", size = 6, fontface = "plain") +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_segment(x = 1, xend = 2, y = 1.1, yend = 1.1) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 2, y = 1.25, label = "P &lt; 0.001", size = 6, fontface = "plain")+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_segment(x = 1, xend = 3, y = 1.2, yend = 1.2)+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 2.5, y = 1.1, label = "P = <b>0.004</b>", size = 6, fontface = "plain")+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_segment(x = 2, xend = 3, y = 1.05, yend = 1.05)+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>guides(fill=guide_legend(title=NULL))</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">#Invese Simpson</span></p>
<p class="p1"><span class="s1">SP_input &lt;- read.csv("SP_IBD.csv", header = TRUE, na.strings = c(NA, ''), row.names=1) #abundance data</span></p>
<p class="p1"><span class="s1">SP_input2 &lt;- SP_input[, -which (colnames(SP_input) %in% c("ID", "IBD", "UC", "CD"))]<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1">DATA=otu_table(SP_input2, taxa_are_rows = FALSE)</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Simpson_SP&lt;-diversity(SP_input2,index="inv<b>simpson</b>",base=2) %&gt;% as.data.frame()<span class="Apple-converted-space">  </span>#Simpson, invsimpson</span><span class="s2"> can be selected.</span></p>
<p class="p1"><span class="s1">colnames(Simpson_SP)[1] &lt;- "Simpson"</span></p>
<p class="p1"><span class="s1">rownames_to_column(Simpson_SP, "METAF") -&gt; Simpson_SP</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Simpson_SP &lt;- full_join(Simpson_SP, Meta, by = "METAF")</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">ggplot(Simpson_SP, aes(Group, Simpson, fill = Group)) +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_violin(aes(group = Group), width = 0.5) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_fill_manual(values = c("royalblue","#84919e","red"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_boxplot(aes(group = Group), fill = "white", width = 0.1) +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme_classic() +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>labs(x = "", y = "Inverse Simpson for species") +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_y_continuous(limits = c(0, 100)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_x_discrete(limit=c("Controls","UC","CD"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme(axis.text.x = element_text(angle = 0, hjust = 0.5, size = 18),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>axis.text.y = element_text(angle = 0, hjust = 0.5, size = 18),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>text = element_text(size = 18)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 1.5, y = 79, label = "P &lt; 0.001", size = 6, fontface = "plain") +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_segment(x = 1, xend = 2, y = 76, yend = 76) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 2, y = 85, label = "P &lt; 0.001", size = 6, fontface = "plain")+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_segment(x = 1, xend = 3, y = 82, yend = 82)+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 2.5, y = 75, label = "P = <b>0.004</b>", size = 6, fontface = "plain")+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_segment(x = 2, xend = 3, y = 72, yend = 72)+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>guides(fill=guide_legend(title=NULL))</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">#beta-diversity</span></p>
<p class="p1"><span class="s1">adonis2(SP_input2~Group, data=Meta, permutation=9999, method="bray")<span class="Apple-converted-space"> </span></span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">data_phylo&lt;-phyloseq(DATA, METADATA)</span></p>
<p class="p1"><span class="s1">bc=ordinate(data_phylo, method = "MDS", distane = "bray") #NMDS</span><span class="s2">など選べる</span></p>
<p class="p1"><span class="s1">plot_ordination(data_phylo, bc, color= "Group")+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_point(size=3)+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>stat_ellipse() +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>labs(x = "MDS1", y = "MDS2") +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_color_manual(values = c("royalblue","#84919e","red"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme(axis.text.x = element_text(angle = 0, hjust = 0.5, size = 20),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>axis.text.y = element_text(angle = 0, hjust = 0.5, size = 20),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>axis.line = element_line(colour = "black", linewidth= 0.7, linetype = "solid"),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>legend.background = element_blank(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>legend.key = element_blank(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>legend.box.background = element_rect(colour = "black"),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>panel.grid.major = element_blank(),<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>panel.grid.minor = element_blank(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>panel.background = element_blank(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>text = element_text(size = 20))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>guides(fill=guide_legend(title=NULL))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 0.4, y = -0.35, label = "P = 1e-04", size = 8, fontface = "plain")</span></p>
<p class="p4"><span class="s1">　</span></p>
<p class="p1"><span class="s1">#RIchness</span></p>
<p class="p1"><span class="s1">SP_input &lt;- read.csv("SP_IBD_num.csv", header = TRUE, na.strings = c(NA, ''), row.names=1)<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1">SP_input2 &lt;- SP_input[, -which (colnames(SP_input) %in% c("ID", "IBD", "UC", "CD"))]<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1">rownames_to_column(SP_input2, "METAF") -&gt; SP_input2</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Richness_SP &lt;- full_join(SP_input2, Meta, by = "METAF")</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">ggplot(Richness_SP, aes(Group, Richness, fill = Group)) +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_violin(aes(group = Group), width = 0.5) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_fill_manual(values = c("royalblue","#84919e","red"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_boxplot(aes(group = Group), fill = "white", width = 0.1) +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme_classic() +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>labs(x = "", y = "Richness for species") +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_y_continuous(limits = c(0,<span class="Apple-converted-space">  </span>600)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_x_discrete(limit=c("Controls","UC","CD"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme(axis.text.x = element_text(angle = 0, hjust = 0.5, size = 18),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>axis.text.y = element_text(angle = 0, hjust = 0.5, size = 18),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>text = element_text(size = 18)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 1.5, y = 570, label = "P &lt; 0.001", size = 6, fontface = "plain") +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_segment(x = 1, xend = 2, y = 555, yend = 555) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 2, y = 600, label = "P &lt; 0.001", size = 6, fontface = "plain")+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_segment(x = 1, xend = 3, y = 585, yend = 585)+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 2.5, y = 540, label = "P = <b>0.007</b>", size = 6, fontface = "plain")+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_segment(x = 2, xend = 3, y = 525, yend = 525)+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>guides(fill=guide_legend(title=NULL))</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p3"><span class="s1"><b>#ARG</b></span></p>
<p class="p1"><span class="s1">#Shannon</span></p>
<p class="p1"><span class="s1">setwd("/Users/akiyama/Documents/</span><span class="s2">筑波大学</span><span class="s1">/</span><span class="s2">筑波大学研究</span><span class="s1">/</span><span class="s2">プロジェクト</span><span class="s1">/Microbiome</span><span class="s2">共同研究</span><span class="s1">/Figure</span><span class="s2">用解析</span><span class="s1">/Bacteriome_all_results_for_pval/Diversity/Microbiome_diversity")</span></p>
<p class="p1"><span class="s1">Meta &lt;- read.csv("Meta.csv", header = TRUE, na.strings = c(NA, ''), row.names=1)</span></p>
<p class="p1"><span class="s1">Meta &lt;- rename(Meta, Group = UC_CD)</span></p>
<p class="p1"><span class="s1">METADATA=sample_data(Meta, errorIfNULL = TRUE)</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">ARG_input &lt;- read.csv("ARG_IBD.csv", header = TRUE, na.strings = c(NA, ''), row.names=1) #abundance data</span></p>
<p class="p1"><span class="s1">ARG_input2 &lt;- ARG_input[, -which (colnames(ARG_input) %in% c("IBD_HC2", "IBD_1", "UC", "Crohn"))]<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1">DATA=otu_table(ARG_input2, taxa_are_rows = FALSE)</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Shannon_ARG&lt;-diversity(ARG_input2,index="shannon",base=2) %&gt;% as.data.frame()<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1">colnames(Shannon_ARG)[1] &lt;- "Shannon"</span></p>
<p class="p1"><span class="s1">Shannon_ARG &lt;- cbind(Shannon_ARG, Meta)</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">ggplot(Shannon_ARG, aes(Group, Shannon, fill = Group)) +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_violin(aes(group = Group), width = 0.5) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_fill_manual(values = c("royalblue","#84919e","red"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_boxplot(aes(group = Group), fill = "white", width = 0.1) +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme_classic() +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>labs(x = "", y = "Shannon for ARG") +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_y_continuous(limits = c(0, 8)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_x_discrete(limit=c("Controls","UC","CD"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme(axis.text.x = element_text(angle = 0, hjust = 0.5, size = 18),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>axis.text.y = element_text(angle = 0, hjust = 0.5, size = 18),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>text = element_text(size = 18)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>guides(fill=guide_legend(title=NULL))</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">#simpson</span></p>
<p class="p1"><span class="s1">ARG_input &lt;- read.csv("ARG_IBD.csv", header = TRUE, na.strings = c(NA, ''), row.names=1) #abundance data</span></p>
<p class="p1"><span class="s1">ARG_input2 &lt;- ARG_input[, -which (colnames(ARG_input) %in% c("IBD_HC2", "IBD_1", "UC", "Crohn"))]<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1">DATA=otu_table(ARG_input2, taxa_are_rows = FALSE)</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Simpson_ARG&lt;-diversity(ARG_input2,index="simpson",base=2) %&gt;% as.data.frame()<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1">colnames(Simpson_ARG)[1] &lt;- "Simpson"</span></p>
<p class="p1"><span class="s1">Simpson_ARG &lt;- cbind(Simpson_ARG, Meta)</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">ggplot(Simpson_ARG, aes(Group, Simpson, fill = Group)) +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_violin(aes(group = Group), width = 0.5) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_fill_manual(values = c("royalblue","#84919e","red"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_boxplot(aes(group = Group), fill = "white", width = 0.1) +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme_classic() +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>labs(x = "", y = "Simpson for ARG") +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_y_continuous(limits = c(0, 1)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_x_discrete(limit=c("Controls","UC","CD"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme(axis.text.x = element_text(angle = 0, hjust = 0.5, size = 18),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>axis.text.y = element_text(angle = 0, hjust = 0.5, size = 18),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>text = element_text(size = 18)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>guides(fill=guide_legend(title=NULL))</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">#Inverse simpson</span></p>
<p class="p1"><span class="s1">ARG_input &lt;- read.csv("ARG_IBD.csv", header = TRUE, na.strings = c(NA, ''), row.names=1) #abundance data</span></p>
<p class="p1"><span class="s1">ARG_input2 &lt;- ARG_input[, -which (colnames(ARG_input) %in% c("IBD_HC2", "IBD_1", "UC", "Crohn"))]<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1">DATA=otu_table(ARG_input2, taxa_are_rows = FALSE)</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Simpson_ARG&lt;-diversity(ARG_input2,index="invsimpson",base=2) %&gt;% as.data.frame()<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1">colnames(Simpson_ARG)[1] &lt;- "Simpson"</span></p>
<p class="p1"><span class="s1">Simpson_ARG &lt;- cbind(Simpson_ARG, Meta)</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">ggplot(Simpson_ARG, aes(Group, Simpson, fill = Group)) +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_violin(aes(group = Group), width = 0.5) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_fill_manual(values = c("royalblue","#84919e","red"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_boxplot(aes(group = Group), fill = "white", width = 0.1) +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme_classic() +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>labs(x = "", y = "Inverse Simpson for ARG") +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_y_continuous(limits = c(0, 100)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_x_discrete(limit=c("Controls","UC","CD"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme(axis.text.x = element_text(angle = 0, hjust = 0.5, size = 18),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>axis.text.y = element_text(angle = 0, hjust = 0.5, size = 18),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>text = element_text(size = 18)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>guides(fill=guide_legend(title=NULL))</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">#beta-diversity</span></p>
<p class="p1"><span class="s1">adonis2(ARG_input2~Group, data=Meta, permutation=9999, method="bray") #obtain p value for PERMANOVA<span class="Apple-converted-space"> </span></span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">data_phylo&lt;-phyloseq(DATA, METADATA)</span></p>
<p class="p1"><span class="s1">bc=ordinate(data_phylo, method = "MDS", distane = "bray") #NMDS</span><span class="s2">など選べる</span></p>
<p class="p1"><span class="s1">plot_ordination(data_phylo, bc, color= "Group")+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_point(size=3)+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>stat_ellipse() +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>labs(x = "MDS1", y = "MDS2") +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_color_manual(values = c("royalblue","#84919e","red"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme(axis.text.x = element_text(angle = 0, hjust = 0.5, size = 20),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>axis.text.y = element_text(angle = 0, hjust = 0.5, size = 20),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>axis.line = element_line(colour = "black", linewidth= 0.7, linetype = "solid"),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>legend.background = element_blank(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>legend.key = element_blank(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>legend.box.background = element_rect(colour = "black"),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>panel.grid.major = element_blank(),<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>panel.grid.minor = element_blank(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>panel.background = element_blank(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>text = element_text(size = 20))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>guides(fill=guide_legend(title=NULL))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 0.4, y = -0.35, label = "P = 1e-04", size = 8, fontface = "plain")</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">#RIchness</span></p>
<p class="p1"><span class="s1">setwd("/Users/akiyama/Documents/</span><span class="s2">筑波大学</span><span class="s1">/</span><span class="s2">筑波大学研究</span><span class="s1">/</span><span class="s2">プロジェクト</span><span class="s1">/Microbiome</span><span class="s2">共同研究</span><span class="s1">/Figure</span><span class="s2">用解析</span><span class="s1">/Bacteriome_all_results_for_pval/Diversity/Microbiome_diversity")</span></p>
<p class="p1"><span class="s1">Meta &lt;- read.csv("Meta.csv", header = TRUE, na.strings = c(NA, ''), row.names=1)</span></p>
<p class="p1"><span class="s1">Meta &lt;- rename(Meta, Group = UC_CD)</span></p>
<p class="p1"><span class="s1">rownames_to_column(Meta, "ID") -&gt; Meta</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">setwd("/Users/akiyama/Documents/</span><span class="s2">筑波大学</span><span class="s1">/</span><span class="s2">筑波大学研究</span><span class="s1">/</span><span class="s2">プロジェクト</span><span class="s1">/Microbiome</span><span class="s2">共同研究</span><span class="s1">/Manuscript/Nat Com/Revised/MaAsLin/ARG")</span></p>
<p class="p1"><span class="s1">SP_input &lt;- read.csv("ARG.csv", header = TRUE, na.strings = c(NA, ''), row.names=1)<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1">rownames_to_column(SP_input, "ID") -&gt; SP_input2</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Richness_SP &lt;- full_join(SP_input2, Meta, by = "ID")</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">ggplot(Richness_SP, aes(Group, Number_of_ARG, fill = Group)) +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_violin(aes(group = Group), width = 0.5) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_fill_manual(values = c("royalblue","#84919e","red"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_boxplot(aes(group = Group), fill = "white", width = 0.1) +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme_classic() +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>labs(x = "", y = "Richness for ARG") +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_y_continuous(limits = c(0,<span class="Apple-converted-space">  </span>200)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_x_discrete(limit=c("Controls","UC","CD"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme(axis.text.x = element_text(angle = 0, hjust = 0.5, size = 18),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>axis.text.y = element_text(angle = 0, hjust = 0.5, size = 18),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>text = element_text(size = 18)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>#annotate("text", x = 1.5, y = 570, label = "P &lt; 0.001", size = 6, fontface = "plain") +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>#geom_segment(x = 1, xend = 2, y = 555, yend = 555) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>#annotate("text", x = 2, y = 600, label = "P &lt; 0.001", size = 6, fontface = "plain")+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>#geom_segment(x = 1, xend = 3, y = 585, yend = 585)+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 2.5, y = 175, label = "P = <b>0.02</b>", size = 6, fontface = "plain")+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_segment(x = 2, xend = 3, y = 165, yend = 165)+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>guides(fill=guide_legend(title=NULL))</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p3"><span class="s1"><b>#vOTU</b></span></p>
<p class="p1"><span class="s1">#Shannon</span></p>
<p class="p1"><span class="s1">setwd("/Users/akiyama/Documents/</span><span class="s2">筑波大学</span><span class="s1">/</span><span class="s2">筑波大学研究</span><span class="s1">/</span><span class="s2">プロジェクト</span><span class="s1">/Microbiome</span><span class="s2">共同研究</span><span class="s1">/Figure</span><span class="s2">用解析</span><span class="s1">/Bacteriome_all_results_for_pval/Diversity/Microbiome_diversity")</span></p>
<p class="p1"><span class="s1">Meta &lt;- read.csv("Meta.csv", header = TRUE, na.strings = c(NA, ''), row.names=1)</span></p>
<p class="p1"><span class="s1">Meta &lt;- rename(Meta, Group = UC_CD)</span></p>
<p class="p1"><span class="s1">METADATA=sample_data(Meta, errorIfNULL = TRUE)</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">vOTU_input &lt;- read.csv("vOTU_IBD.csv", header = TRUE, na.strings = c(NA, ''), row.names=1) #abundance data</span></p>
<p class="p1"><span class="s1">vOTU_input2 &lt;- vOTU_input[, -which (colnames(vOTU_input) %in% c("IBD_HC2", "UC", "Crohn"))]<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1">DATA=otu_table(vOTU_input2, taxa_are_rows = FALSE)</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Shannon_vOTU&lt;-diversity(vOTU_input2,index="shannon",base=2) %&gt;% as.data.frame()<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1">colnames(Shannon_vOTU)[1] &lt;- "Shannon"</span></p>
<p class="p1"><span class="s1">Shannon_vOTU &lt;- cbind(Shannon_vOTU, Meta)</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">ggplot(Shannon_vOTU, aes(Group, Shannon, fill = Group)) +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_violin(aes(group = Group), width = 0.5) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_fill_manual(values = c("royalblue","#84919e","red"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_boxplot(aes(group = Group), fill = "white", width = 0.1) +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme_classic() +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>labs(x = "", y = "Shannon for vOTU") +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_y_continuous(limits = c(0, 8.5)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_x_discrete(limit=c("Controls","UC","CD"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme(axis.text.x = element_text(angle = 0, hjust = 0.5, size = 18),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>axis.text.y = element_text(angle = 0, hjust = 0.5, size = 18),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>text = element_text(size = 18)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 1.5, y = 7.7, label = "P &lt; 0.001", size = 6, fontface = "plain") +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_segment(x = 1, xend = 2, y = 7.5, yend = 7.5) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 2, y = 8.2, label = "P &lt; 0.001", size = 6, fontface = "plain")+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_segment(x = 1, xend = 3, y = 8, yend = 8)+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 2.5, y = 7.4, label = "P = 0.02", size = 6, fontface = "plain")+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_segment(x = 2, xend = 3, y = 7.2, yend = 7.2)+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>guides(fill=guide_legend(title=NULL))</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">#simpson</span></p>
<p class="p1"><span class="s1">vOTU_input &lt;- read.csv("vOTU_IBD.csv", header = TRUE, na.strings = c(NA, ''), row.names=1) #abundance data</span></p>
<p class="p1"><span class="s1">vOTU_input2 &lt;- vOTU_input[, -which (colnames(vOTU_input) %in% c("IBD_HC2", "UC", "Crohn"))]<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1">DATA=otu_table(vOTU_input2, taxa_are_rows = FALSE)</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Simpson_vOTU&lt;-diversity(vOTU_input2,index="simpson",base=2) %&gt;% as.data.frame()<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1">colnames(Simpson_vOTU)[1] &lt;- "Simpson"</span></p>
<p class="p1"><span class="s1">Simpson_vOTU &lt;- cbind(Simpson_vOTU, Meta)</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">ggplot(Simpson_vOTU, aes(Group, Simpson, fill = Group)) +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_violin(aes(group = Group), width = 0.5) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_fill_manual(values = c("royalblue","#84919e","red"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_boxplot(aes(group = Group), fill = "white", width = 0.1) +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme_classic() +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>labs(x = "", y = "Simpson for vOTU") +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_y_continuous(limits = c(0, 1.3)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_x_discrete(limit=c("Controls","UC","CD"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme(axis.text.x = element_text(angle = 0, hjust = 0.5, size = 18),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>axis.text.y = element_text(angle = 0, hjust = 0.5, size = 18),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>text = element_text(size = 18)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 1.5, y = 1.15, label = "P &lt; 0.001", size = 6, fontface = "plain") +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_segment(x = 1, xend = 2, y = 1.1, yend = 1.1) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 2, y = 1.25, label = "P &lt; 0.001", size = 6, fontface = "plain")+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_segment(x = 1, xend = 3, y = 1.2, yend = 1.2)+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 2.5, y = 1.1, label = "P = <b>0.02</b>", size = 6, fontface = "plain")+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_segment(x = 2, xend = 3, y = 1.05, yend = 1.05)+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>guides(fill=guide_legend(title=NULL))</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">#Inverse Simpson</span></p>
<p class="p1"><span class="s1">vOTU_input &lt;- read.csv("vOTU_IBD.csv", header = TRUE, na.strings = c(NA, ''), row.names=1) #abundance data</span></p>
<p class="p1"><span class="s1">vOTU_input2 &lt;- vOTU_input[, -which (colnames(vOTU_input) %in% c("IBD_HC2", "UC", "Crohn"))]<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1">DATA=otu_table(vOTU_input2, taxa_are_rows = FALSE)</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Simpson_vOTU&lt;-diversity(vOTU_input2,index="invsimpson",base=2) %&gt;% as.data.frame()<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1">colnames(Simpson_vOTU)[1] &lt;- "Simpson"</span></p>
<p class="p1"><span class="s1">Simpson_vOTU &lt;- cbind(Simpson_vOTU, Meta)</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">ggplot(Simpson_vOTU, aes(Group, Simpson, fill = Group)) +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_violin(aes(group = Group), width = 0.5) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_fill_manual(values = c("royalblue","#84919e","red"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_boxplot(aes(group = Group), fill = "white", width = 0.1) +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme_classic() +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>labs(x = "", y = "Inverse Simpson for vOTU") +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_y_continuous(limits = c(0, 100)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_x_discrete(limit=c("Controls","UC","CD"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme(axis.text.x = element_text(angle = 0, hjust = 0.5, size = 18),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>axis.text.y = element_text(angle = 0, hjust = 0.5, size = 18),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>text = element_text(size = 18)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 1.5, y = 79, label = "P &lt; 0.001", size = 6, fontface = "plain") +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_segment(x = 1, xend = 2, y = 76, yend = 76) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 2, y = 85, label = "P &lt; 0.001", size = 6, fontface = "plain")+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_segment(x = 1, xend = 3, y = 82, yend = 82)+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 2.5, y = 75, label = "P = <b>0.02</b>", size = 6, fontface = "plain")+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_segment(x = 2, xend = 3, y = 72, yend = 72)+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>guides(fill=guide_legend(title=NULL))</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">#beta-diversity</span></p>
<p class="p1"><span class="s1">adonis2(vOTU_input2~Group, data=Meta, permutation=9999, method="bray") #obtain p value for PERMANOVA<span class="Apple-converted-space"> </span></span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">data_phylo&lt;-phyloseq(DATA, METADATA)</span></p>
<p class="p1"><span class="s1">bc=ordinate(data_phylo, method = "MDS", distane = "bray") #NMDS</span><span class="s2">など選べる</span></p>
<p class="p1"><span class="s1">plot_ordination(data_phylo, bc, color= "Group")+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_point(size=3)+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>stat_ellipse() +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>labs(x = "MDS1", y = "MDS2") +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_color_manual(values = c("royalblue","#84919e","red"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme(axis.text.x = element_text(angle = 0, hjust = 0.5, size = 20),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>axis.text.y = element_text(angle = 0, hjust = 0.5, size = 20),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>axis.line = element_line(colour = "black", linewidth= 0.7, linetype = "solid"),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>legend.background = element_blank(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>legend.key = element_blank(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>legend.box.background = element_rect(colour = "black"),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>panel.grid.major = element_blank(),<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>panel.grid.minor = element_blank(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>panel.background = element_blank(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>text = element_text(size = 20))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>guides(fill=guide_legend(title=NULL))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 0.4, y = -0.35, label = "P = 1e-04", size = 8, fontface = "plain")</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">#RIchness<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1">setwd("/Users/akiyama/Documents/</span><span class="s2">筑波大学</span><span class="s1">/</span><span class="s2">筑波大学研究</span><span class="s1">/</span><span class="s2">プロジェクト</span><span class="s1">/Microbiome</span><span class="s2">共同研究</span><span class="s1">/Figure</span><span class="s2">用解析</span><span class="s1">/Bacteriome_all_results_for_pval/Diversity/Microbiome_diversity")</span></p>
<p class="p1"><span class="s1">Meta &lt;- read.csv("Meta.csv", header = TRUE, na.strings = c(NA, ''), row.names=1)</span></p>
<p class="p1"><span class="s1">Meta &lt;- rename(Meta, Group = UC_CD)</span></p>
<p class="p1"><span class="s1">rownames_to_column(Meta, "ID") -&gt; Meta</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">setwd("/Users/akiyama/Documents/</span><span class="s2">筑波大学</span><span class="s1">/</span><span class="s2">筑波大学研究</span><span class="s1">/</span><span class="s2">プロジェクト</span><span class="s1">/Microbiome</span><span class="s2">共同研究</span><span class="s1">/Manuscript/Nat Com/Revised/MaAsLin/Phage")</span></p>
<p class="p1"><span class="s1">SP_input &lt;- read.csv("vOTU_num.csv", header = TRUE, na.strings = c(NA, ''), row.names=1)</span></p>
<p class="p1"><span class="s1">rownames_to_column(SP_input, "ID") -&gt; SP_input2</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">Richness_SP &lt;- full_join(SP_input2, Meta, by = "ID")</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">ggplot(Richness_SP, aes(Group, Richness, fill = Group)) +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_violin(aes(group = Group), width = 0.5) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_fill_manual(values = c("royalblue","#84919e","red"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_boxplot(aes(group = Group), fill = "white", width = 0.1) +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme_classic() +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>labs(x = "", y = "Richness for vOTU") +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_y_continuous(limits = c(0,<span class="Apple-converted-space">  </span>280)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>scale_x_discrete(limit=c("Controls","UC","CD"))+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>theme(axis.text.x = element_text(angle = 0, hjust = 0.5, size = 18),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>axis.text.y = element_text(angle = 0, hjust = 0.5, size = 18),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>text = element_text(size = 18)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 1.5, y = 230, label = "P &lt; 0.001", size = 6, fontface = "plain") +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_segment(x = 1, xend = 2, y = 220, yend = 220) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>annotate("text", x = 2, y = 260, label = "P &lt; 0.001", size = 6, fontface = "plain")+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>geom_segment(x = 1, xend = 3, y = 250, yend = 250)+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>#annotate("text", x = 2.5, y = 180, label = "P = <b>0.02</b>", size = 6, fontface = "plain")+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>#geom_segment(x = 2, xend = 3, y = 165, yend = 165)+</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>guides(fill=guide_legend(title=NULL))</span></p>
<p class="p4"><span class="s1">　</span></p>
<p class="p5"><span class="s3"><b>#Alpha-diversity</b></span><span class="s1"><b> box and whisker plots<span class="Apple-converted-space"> </span></b></span></p>
<p class="p1"><span class="s1"><b>#SP</b></span></p>
<p class="p1"><span class="s1">#Shannon</span></p>
<p class="p1"><span class="s1">#Box-and-whisker plots with P val</span><span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1">ggbetweenstats(plot.type = "box", data = Shannon_SP, x = Group, y = Shannon, type = "nonparametirc", title = "alpha-diversity",<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>centrality.plotting = TRUE, <span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>centrality.point.args = list(size = 2, color = "darkred"),<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>centrality.label.args = list(size = 1, nudge_x = 0.5, segment.linetype = 2, min.segment.length = 0),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ggplot.component = list(theme(text=element_text(size=10))),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>results.subtitle = TRUE)</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">#ARG</span></p>
<p class="p1"><span class="s1">ggbetweenstats(plot.type = "box", data = Shannon_ARG, x = Group, y = Shannon, type = "nonparametirc", title = "alpha-diversity",<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>centrality.plotting = TRUE, <span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>centrality.point.args = list(size = 2, color = "darkred"),<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>centrality.label.args = list(size = 1, nudge_x = 0.5, segment.linetype = 2, min.segment.length = 0),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ggplot.component = list(theme(text=element_text(size=10))),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>results.subtitle = TRUE)</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">#vOTU</span></p>
<p class="p1"><span class="s1">ggbetweenstats(plot.type = "box", data = Shannon_vOTU, x = Group, y = Shannon, type = "nonparametirc", title = "alpha-diversity",<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>centrality.plotting = TRUE, <span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>centrality.point.args = list(size = 2, color = "darkred"),<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>centrality.label.args = list(size = 1, nudge_x = 0.5, segment.linetype = 2, min.segment.length = 0),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ggplot.component = list(theme(text=element_text(size=10))),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>results.subtitle = TRUE)</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
</body>
</html>
